<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <%- include('import.ejs') -%>

    <title>Data OnGoing</title>
    <script>
      function checkPasswordAndRedirect(password, url, save) {
        const enteredPassword = prompt("Please enter the password:");
        if (enteredPassword === password) {
          if (save === true) {
            localStorage.setItem("password", enteredPassword);
          }

          // Jika password benar, simpan di local storage
          window.location.href = url;
        } else {
          alert("Incorrect password. You will be redirected to the main page.");
          window.location.href = "/";
        }
      }
      function encrypt(text) {
        // Contoh sederhana, mengganti karakter
        return text
          .split("")
          .map((char) => String.fromCharCode(char.charCodeAt(0) + 1))
          .join("");
      }

      function decrypt(encryptedText) {
        // Mendekripsi teks (mengganti karakter kembali)
        return encryptedText
          .split("")
          .map((char) => String.fromCharCode(char.charCodeAt(0) - 1))
          .join("");
      }

      const initialPassword = decrypt("bunjoNbvMphjo");
      const savedPassword = localStorage.getItem("password");

      if (!savedPassword && initialPassword) {
        checkPasswordAndRedirect(initialPassword, window.location.href, true);
      }
    </script>
  </head>
  <body>
    <%- include('navbar.ejs') -%>

    <div class="container">
      <h1 class="mt-3">Data OnGoing</h1>
      <ul class="list-group">
        <% data.forEach(function(entry) { %>
        <li class="list-group-item">
          <p><strong>ID:</strong> <%= entry.id %></p>
          <p><strong>Title:</strong> <%= entry.Title %></p>
          <a class="btn btn-primary" href="/details/ongoing/<%= entry.id %>">
            Lihat Contentnya
          </a>
          <button
            class="btn btn-success"
            onclick="checkPasswordAndRedirect('atminSudahDatang', '/accept/<%= entry.id %>', false)">
            <i class="fa fa-check" aria-hidden="true"></i>
          </button>
          <button
            class="btn btn-danger"
            onclick="checkPasswordAndRedirect('atminSudahDatang', '/accept/delete/<%= entry.id %>', false)">
            <i class="fa fa-trash" aria-hidden="true"></i>
          </button>
        </li>
        <% }); %>
      </ul>
    </div>
  </body>
</html>
