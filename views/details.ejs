<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <%- include('import.ejs') -%>
    <title><%= data.Title %> - rejangpedia</title>
    <meta
      property="og:title"
      content="rejangpedia untuk Sanak: <%= data.Title %>" />
    <meta
      property="og:description"
      content="<%- data.Content[0].babContent.replace(/<[^>]+>/g,
    '').substring(0, 200) %>..." />
    <meta property="og:image" content="<%= data.Image %>" />
    <meta
      property="og:url"
      content="https://rejang-pedia.mfathinhalim.repl.co/details/<%= data.id %>" />
  </head>
  <%- include('navbar.ejs') -%>

  <style>
    img {
      width: 460px; /* Default width for desktop */
      max-width: 100%; /* Ensure it's responsive */
    }
    @media only screen and (max-width: 600px) {
      .listing-image {
        min-width: 100% !important;
        min-height: fit-content !important;
        object-fit: cover !important;
      }
    }
  </style>
  <body>
    <% if (data && data.Title){ %>
    <div class="container p-3">
      <h3><%= data.Title %></h3>
      <div
        class="card bg-transparent border mb-3 mt-3"
        style="width: fit-content; border-radius: 12px">
        <div class="card-body">
          <h5 class="card-title">Dimulai Oleh: <%= data.Pembuat %></h5>
          <p class="card-text">Diedit Terakhir: <%= data.Diedit %></p>
        </div>
      </div>
      <div class="d-flex flex-column flex-md-row">
        <% if (data.Image && data.Image != null) { %>
        <img
          class="listing-image mr-2"
          style="
            height: 250px;
            width: fit-content;
            border: 1px solid #ccc;
            object-fit: contain;
            background: rgba(0, 0, 0, 0) !important;
            border-radius: 12px;
          "
          src="<%= data.Image %>"
          alt="<%= data.Title %>" />
        <br />
        <% } %> <% if (data.Link) { %>
        <article>
          <iframe
            style="
              width: 460px;
              max-width: 100%;
              height: 250px;
              object-fit: cover;
              border-radius: 12px;
              border: 1px solid #ccc;
            "
            class="img-fluid"
            src="<%= data.Link %>">
          </iframe>
        </article>
        <% } %>
      </div>

      <div class="d-flex mt-3">
        <button
          class="btn btn-info rounded-pill mr-1 text-white"
          onclick="search()">
          <i class="fa fa-share text-white" aria-hidden="true"></i>
          Bagikan
        </button>
        <a class="btn btn-secondary rounded-pill" href="/edit/<%= data.id %>">
          <i class="fa fa-pencil" aria-hidden="true"></i>
          Edit Artikel
        </a>
      </div>

      <div style="border-radius: 24px !important">
        <% data.Content.forEach(function(bab) { %>
        <div class="my-4">
          <h3><%= bab.babTitle %></h3>
          <p><%- bab.babContent %></p>
        </div>
        <% }); %>
      </div>
    </div>
    <% } else { %>
    <p>Data not available.</p>
    <% } %>
  </body>
  <script>
    function search() {
      // Get the text field
      var copyText = window.location.href;

      // Copy the text inside the text field
      if (navigator.share) {
        navigator.clipboard.writeText(copyText);

        navigator
          .share({
            title: "rejangpedia",
            text: "artikel untuk sanak",
            url: copyText,
          })
          .then(() => console.log("Successful share"))
          .catch((error) => console.log("Error sharing", error));
      } else {
        try {
          window.AndroidShareHandler.share(copyText);
        } catch {
          navigator.clipboard.writeText(copyText);
          alert("Sudah Di Salin Ya, silahkan Beri ke Temanmu ya ^_^");
        }
      }
    }
  </script>
</html>
